# Development Dockerfile for .NET API with hot reload support
FROM mcr.microsoft.com/dotnet/sdk:9.0 AS development

WORKDIR /app

# Install debugger
RUN curl -sSL https://aka.ms/getvsdbgsh | bash /dev/stdin -v latest -l /vsdbg

# Install dotnet tools globally
ENV PATH="${PATH}:/root/.dotnet/tools"
RUN dotnet tool install --global dotnet-ef
RUN dotnet tool install --global dotnet-watch

# Copy project files
COPY *.csproj ./
RUN dotnet restore

# Copy source code
COPY . ./

# Set environment variables for development
ENV DOTNET_USE_POLLING_FILE_WATCHER=1
ENV ASPNETCORE_ENVIRONMENT=Development
ENV DOTNET_WATCH_RESTART_ON_RUDE_EDIT=1

EXPOSE 5000

# Default command - can be overridden in docker-compose
CMD ["dotnet", "watch", "run", "--urls", "http://0.0.0.0:5000"]